<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DASBEM Loader</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b0c0e;
  --text:#33ff33;
  --accent:#ffaa33;
  --highlight:#ffff66;
}
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:var(--bg);
  color:var(--text);
  font-family:'Share Tech Mono', monospace;
  overflow:hidden;
}
#loaderContainer{
  position:relative;
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  padding:20px;
  box-sizing:border-box;
}
#header{
  font-size:1.6rem;
  font-weight:bold;
  color:var(--accent);
  margin-bottom:20px;
  letter-spacing:1px;
}
#log{
  flex:1;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  gap:2px;
  font-size:0.95rem;
}
.logLine{
  white-space:pre;
  opacity:0;
}
.progressBarContainer{
  width:100%;
  height:20px;
  background:rgba(255,255,255,0.1);
  border-radius:6px;
  margin-top:20px;
  overflow:hidden;
}
.progressBar{
  width:0%;
  height:100%;
  background:var(--accent);
  transition:width 0.15s linear;
}
@media (max-width:640px){
  #header{font-size:1.3rem;}
  .progressBarContainer{height:16px;}
  #log{font-size:0.8rem;}
}
</style>
</head>
<body>
<div id="loaderContainer">
  <div id="header">Initializing The DASBEM Project...</div>
  <div id="log"></div>
  <div class="progressBarContainer"><div class="progressBar" id="progressBar"></div></div>
</div>

<script>
function tehranTime(){
  const now = new Date();
  const utc = now.getTime() + now.getTimezoneOffset() * 60000;
  return new Date(utc + 3.5 * 60 * 60 * 1000);
}
function timeStamp(){
  const t = tehranTime();
  const hh=('0'+t.getHours()).slice(-2);
  const mm=('0'+t.getMinutes()).slice(-2);
  const ss=('0'+t.getSeconds()).slice(-2);
  return `[${hh}:${mm}:${ss}]`;
}

const logEl = document.getElementById('log');
const progressEl = document.getElementById('progressBar');

// --- مراحل تخصصی DASBEM ---
const logLines = [
  "Loading boundary element matrices...",
  "Initializing SH-wave solver...",
  "Applying topography parameters...",
  "Computing half-plane responses...",
  "Assembling modified boundary integrals...",
  "Generating influence coefficient matrices...",
  "Formulating time-domain convolution kernels...",
  "Constructing global dynamic stiffness matrix...",
  "Solving step-by-step in time domain...",
  "Extracting nodal displacement vectors...",
  "Computing surface amplification ratios...",
  "Mapping ground motion amplification contours...",
  "Storing response history arrays...",
  "Updating numerical integration modules...",
  "Normalizing boundary condition sets...",
  "Optimizing matrix decomposition routines...",
  "Generating output data files...",
  "Synchronizing visualization renderer...",
  "Finalizing DASBEM computational sequence...",
  "System Ready."
];

// ---- کنترل مدت زمان کل: 5 ثانیه ----
const totalDuration = 5000; // ms
const stepTime = totalDuration / logLines.length;
let currentStep = 0;

function appendLog(text,color){
  const line = document.createElement('div');
  line.className='logLine';
  line.textContent = `${timeStamp()} ${text}`;
  if(color) line.style.color=color;
  logEl.appendChild(line);
  logEl.scrollTop = logEl.scrollHeight;
  fadeIn(line);
}

function fadeIn(el){
  let op=0;
  const interval = setInterval(()=>{
    op+=0.1;
    el.style.opacity=op;
    if(op>=1) clearInterval(interval);
  },30);
}

function startLoader(){
  logLines.forEach((line,i)=>{
    setTimeout(()=>{
      let color = "var(--text)";
      if(line.includes("Ready")) color = "var(--highlight)";
      appendLog(line,color);
      currentStep++;
      progressEl.style.width = Math.floor((currentStep/logLines.length)*100)+"%";
    }, i*stepTime);
  });
}
startLoader();
</script>
</body>
</html>
