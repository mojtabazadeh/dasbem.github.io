<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DASBEM Loader</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#060606;
  --text:#39ff14;
  --accent:#ffaa33;
  --highlight:#ffff66;
}
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:var(--bg);
  color:var(--text);
  font-family:'Share Tech Mono', monospace;
  overflow:hidden;
}
#loaderContainer{
  position:relative;
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  padding:20px;
  box-sizing:border-box;
}
#header{
  font-size:1.4rem;
  color:var(--accent);
  letter-spacing:1px;
  margin-bottom:10px;
}
#log{
  flex:1;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  font-size:0.9rem;
  line-height:1.2rem;
  white-space:pre;
}
.logLine{
  opacity:0;
  animation:fadeIn 0.2s linear forwards;
}
@keyframes fadeIn{
  from{opacity:0;}
  to{opacity:1;}
}
.progressBarContainer{
  width:100%;
  height:18px;
  background:rgba(255,255,255,0.1);
  border-radius:6px;
  overflow:hidden;
  margin-top:10px;
}
.progressBar{
  width:0%;
  height:100%;
  background:var(--accent);
  transition:width 0.15s linear;
}

/* Grid flicker background */
.grid{
  position:absolute;
  top:0;left:0;
  width:100%;height:100%;
  background-image:linear-gradient(rgba(0,255,0,0.05) 1px, transparent 1px),
                   linear-gradient(90deg, rgba(0,255,0,0.05) 1px, transparent 1px);
  background-size:20px 20px;
  animation:gridMove 3s linear infinite;
  z-index:-1;
}
@keyframes gridMove{
  0%{background-position:0 0;}
  100%{background-position:20px 20px;}
}

@media(max-width:640px){
  #header{font-size:1.2rem;}
  #log{font-size:0.75rem;}
  .progressBarContainer{height:14px;}
}
</style>
</head>
<body>
<div class="grid"></div>
<div id="loaderContainer">
  <div id="header">Initializing DASBEM Computational Core...</div>
  <div id="log"></div>
  <div class="progressBarContainer"><div class="progressBar" id="progressBar"></div></div>
</div>

<script>
function tehranTime(){
  const now = new Date();
  const utc = now.getTime() + now.getTimezoneOffset() * 60000;
  return new Date(utc + 3.5 * 60 * 60 * 1000);
}
function timeStamp(){
  const t = tehranTime();
  return `[${('0'+t.getHours()).slice(-2)}:${('0'+t.getMinutes()).slice(-2)}:${('0'+t.getSeconds()).slice(-2)}]`;
}

// فایل‌های فرضی (بیش از 500 عدد)
const technicalPhrases = [
  "Loading boundary element matrices...",
  "Initializing SH-wave solver...",
  "Applying topography parameters...",
  "Computing half-plane Green’s functions...",
  "Assembling modified BIEs...",
  "Generating stiffness submatrices...",
  "Integrating fundamental solutions...",
  "Applying non-reflective boundary conditions...",
  "Solving domain decomposition scheme...",
  "Updating convolution integrals...",
  "Calculating amplification coefficients...",
  "Formulating recursive time-domain relations...",
  "Performing LU decomposition...",
  "Optimizing matrix-vector multiplications...",
  "Synchronizing parallel solver threads...",
  "Writing response data to output stream...",
  "Finalizing numerical kernel...",
  "Validating dynamic equilibrium...",
  "Saving results to /output/DASBEM_run.dat",
  "System Ready."
];

const logEl = document.getElementById("log");
const progressEl = document.getElementById("progressBar");

let totalLines = 500; // حس فایل‌های زیاد
let displayed = 0;
let totalDuration = 5000; // کل زمان ≈ 5 ثانیه
let intervalTime = totalDuration / totalLines;

function appendLog(text){
  const line = document.createElement("div");
  line.className = "logLine";
  line.textContent = `${timeStamp()} ${text}`;
  logEl.appendChild(line);
  logEl.scrollTop = logEl.scrollHeight;
}

function randomPhrase(){
  return technicalPhrases[Math.floor(Math.random()*technicalPhrases.length)];
}

function startLoader(){
  const interval = setInterval(()=>{
    appendLog(randomPhrase());
    displayed++;
    let percent = Math.min(100, (displayed/totalLines)*100);
    progressEl.style.width = percent + "%";
    if(displayed >= totalLines){
      clearInterval(interval);
      setTimeout(()=>{
        appendLog(">>> Redirecting to Main Interface...");
        progressEl.style.width = "100%";
        setTimeout(()=>window.location.href="index.html",1000); // مسیر مقصد سایت
      },300);
    }
  }, intervalTime);
}

startLoader();
</script>
</body>
</html>
