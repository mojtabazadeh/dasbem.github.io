<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DASBEM — Loader</title>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg-dark:#1a1a1a;
  --text-light:#fff;
  --accent:#ffb347;
  --muted:#ddd;
}
*{box-sizing:border-box;margin:0;padding:0;}
html,body{height:100%;overflow:hidden;font-family:"Poppins",sans-serif;background:var(--bg-dark);}
body{color:var(--text-light);}

/* ===== Loader Container ===== */
#loader{
  position:fixed;inset:0;background:var(--bg-dark);display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:9999;
}
.terminal-box{
  width:600px;max-width:90%;background:rgba(0,0,0,0.8);border-radius:12px;padding:24px;box-shadow:0 8px 32px rgba(0,0,0,0.7);overflow:hidden;
}
.terminal-line{
  font-family:"Fira Code", monospace;font-size:14px;color:var(--muted);line-height:1.4;white-space:pre;
}
.terminal-line .tag{color:var(--accent);display:inline-block;min-width:80px;font-weight:700;}
.terminal-line.typing{color:var(--accent);font-weight:700;}
.progress-bar{margin-top:16px;width:100%;height:10px;background:rgba(255,255,255,0.05);border-radius:999px;overflow:hidden;}
.progress-bar .fill{width:0%;height:100%;background:var(--accent);transition:width 0.2s linear;}

/* ===== Orange Curtain ===== */
#orangeCurtain{
  position:fixed;inset:0;background:var(--accent);opacity:0;pointer-events:none;z-index:10000;
  transition:opacity 1s ease;
}

/* ===== Main Content ===== */
#mainApp{opacity:0;visibility:hidden;transition:opacity 1s ease, visibility 0s 1s;padding:60px;text-align:center;color:var(--text-light);}
#mainApp h1{font-size:2.5rem;margin-bottom:16px;}
#mainApp p{font-size:1.2rem;color:var(--muted);}
</style>
</head>
<body>

<!-- Loader -->
<div id="loader">
  <div class="terminal-box">
    <div class="terminal-line"><span class="tag">system</span> initializing kernel...</div>
    <div class="terminal-line"><span class="tag">core</span> loading modules...</div>
    <div class="terminal-line typing" id="typingLine"></div>
    <div class="progress-bar"><div class="fill" id="progressFill"></div></div>
  </div>
</div>

<div id="orangeCurtain"></div>

<!-- Main Content -->
<main id="mainApp">
  <h1>The DASBEM Project</h1>
  <p>Dynamic Analysis of Structures by Boundary Element Method</p>
</main>

<script>
/* ===== Terminal Typing ===== */
const typingLine = document.getElementById('typingLine');
const progressFill = document.getElementById('progressFill');
const loaderDuration = 5000; // 5 ثانیه
const startTime = performance.now();
const textLines = [
  "Initializing DASBEM Project...",
  "Allocating boundary elements...",
  "Assembling influence matrices...",
  "Optimizing solver parameters..."
];

let currentLine = 0;
function typeLine(line, el, speed=40){
  return new Promise(resolve=>{
    el.textContent = "";
    let i=0;
    function tick(){
      if(i<=line.length){
        el.textContent = line.slice(0,i) + (i%2?"▌":"");
        i++;
        setTimeout(tick, speed + (Math.random()*20-10));
      } else{
        el.textContent = line;
        resolve();
      }
    }
    tick();
  });
}

/* ===== Animate Terminal + Progress ===== */
async function runLoader(){
  const fill = document.getElementById('progressFill');
  const interval = loaderDuration / textLines.length;
  for(const line of textLines){
    await typeLine(line, typingLine);
    currentLine++;
    fill.style.width = ((currentLine/textLines.length)*80) + "%";
    await new Promise(r=>setTimeout(r, interval*0.2));
  }
  // Gradually fill remaining 20%
  let start = performance.now();
  function fillRemaining(now){
    let pct = Math.min(100,80 + (now-start)/1000*20);
    fill.style.width = pct + "%";
    if(pct<100) requestAnimationFrame(fillRemaining);
    else showCurtain();
  }
  requestAnimationFrame(fillRemaining);
}

/* ===== Orange Curtain Reveal ===== */
function showCurtain(){
  const curtain = document.getElementById('orangeCurtain');
  curtain.style.opacity = "1";
  setTimeout(()=>{
    curtain.style.opacity = "0";
    document.getElementById('loader').style.display="none";
    const main = document.getElementById('mainApp');
    main.style.visibility="visible";
    main.style.opacity="1";
  },1000);
}

runLoader();
</script>
</body>
</html>
