<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>DASBEM Loader</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#050505;
  --text:#39ff14;
  --accent:#ff9900;
  --gold:#ffcc33;
  --muted: rgba(255,255,255,0.06);
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:'Share Tech Mono',monospace;overflow:hidden}
#app{position:relative;height:100%;width:100%;padding:18px;display:flex;flex-direction:column;gap:12px}
#header{font-size:17px;color:var(--accent);letter-spacing:1px;user-select:none;max-width:100%;overflow:hidden;white-space:nowrap}
.viewport{flex:1;min-height:120px;overflow-y:auto;padding:10px 12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border-radius:8px;border:1px solid rgba(255,255,255,0.03)}
.logLine{font-size:13px;line-height:1.25;margin:6px 0;opacity:0;transform:translateY(4px);transition:opacity .12s linear, transform .12s linear;max-width:100%;word-break:break-word;white-space:pre-wrap;display:block;position:relative;padding-right:6px}
.logLine.visible{opacity:1; transform:translateY(0);}
.finalLine{color:var(--gold);font-weight:700;font-size:15px;text-shadow:0 0 6px rgba(255,204,51,0.14);margin-top:8px;padding:6px 8px;border-radius:6px;background:linear-gradient(90deg, rgba(255,204,51,0.04), transparent);}
.progressWrap{height:16px;background:rgba(255,255,255,0.06);border-radius:10px;overflow:hidden;border:1px solid rgba(255,255,255,0.03)}
.progressBar{height:100%;width:0;background:linear-gradient(90deg,#ff9900,#ffcc33);transition:width 80ms linear}
.grid{pointer-events:none;position:fixed;inset:0;z-index:0;background-image:linear-gradient(rgba(255,153,0,0.06) 1px, transparent),linear-gradient(90deg, rgba(255,204,51,0.05) 1px, transparent 1px);background-size:18px 18px;mix-blend-mode:overlay;opacity:0.65}
.glow{pointer-events:none;position:fixed;left:50%;transform:translateX(-50%);bottom:-40%;width:160%;height:160%;background:radial-gradient(circle at 50% 120%, rgba(255,153,0,0.12), transparent 60%);z-index:0;opacity:0.9}
.glitch{animation:glitchShift 80ms linear;}
@keyframes glitchShift {0% {transform:translateX(0) skewX(0deg);opacity:1;}50% {transform:translateX(-6px) skewX(-2deg);opacity:0.95;}100% {transform:translateX(3px) skewX(1deg);opacity:1;}}
.glitchStrip::before{content:"";position:absolute;left:0;right:0;top:0;height:30%;transform:translateY(0);background:linear-gradient(90deg, rgba(255,200,80,0.06), rgba(255,120,30,0.04));mix-blend-mode:screen;pointer-events:none;clip-path: inset(0 0 70% 0);animation:stripShift 90ms linear;}
@keyframes stripShift {0% {transform:translateX(0);opacity:0.98;}50% {transform:translateX(-10px);opacity:0.9;}100% {transform:translateX(6px);opacity:0.98;}}
@media (max-width:640px){#app{padding:12px}#header{font-size:15px}.logLine{font-size:12px;margin:8px 0}.progressWrap{height:14px}}
</style>
</head>
<body>
<div class="grid" aria-hidden="true"></div>
<div class="glow" aria-hidden="true"></div>
<div id="app" role="main" aria-live="polite">
  <div id="header" aria-hidden="false">Initializing The DASBEM Project Core...</div>
  <div class="viewport" id="viewport" role="region" aria-label="Loader log"></div>
  <div class="progressWrap" aria-hidden="false" aria-label="Loading progress">
    <div class="progressBar" id="progressBar"></div>
  </div>
</div>

<script>
const TOTAL_DURATION=3000, TOTAL_LINES=300, REDIRECT="index.html";
const viewport=document.getElementById('viewport'), progressBar=document.getElementById('progressBar'), header=document.getElementById('header');
function localTimeString(){const now=new Date();const utc=now.getTime()+now.getTimezoneOffset()*60000;const t=new Date(utc+3.5*3600*1000);return `[${String(t.getHours()).padStart(2,'0')}:${String(t.getMinutes()).padStart(2,'0')}:${String(t.getSeconds()).padStart(2,'0')}]`;}

// templates for realistic module/file loading lines
const templates=[
"Loading module '{mod}'...",
"Initializing subroutine '{mod}'...",
"Fetching resource '{res}'...",
"Allocating memory for object '{obj}'...",
"Parsing input data '{data}'...",
"Computing convolution block {blk}...",
"Synchronizing solver threads ({th})...",
"Applying boundary conditions ({bc})...",
"Finalizing module '{mod}'...",
"Storing output to '{file}'..."
];

function rnd(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
function pick(a){return a[rnd(0,a.length-1)];}
function makeLine(){return pick(templates).replace(/\{([^\}]+)\}/g,(_,t)=>{switch(t){case 'mod':return pick(['core','conv','solver','io','post']);case 'res':return pick(['kernel','matrix','coeff','mesh']);case 'obj':return pick(['block','node','patch']);case 'data':return pick(['input','boundary','element']);case 'blk':return rnd(1,32);case 'th':return rnd(1,12);case 'bc':return pick(['free-surface','non-reflective','periodic']);case 'file':return `/output/${pick(['resp','log','data'])}_${rnd(1000,9999)}.bin`;default:return ''}});}

const timestamps=(function(){const arr=[];for(let i=0;i<TOTAL_LINES;i++){const base=(i/TOTAL_LINES)*TOTAL_DURATION;const jitter=(1-i/TOTAL_LINES)*18;arr.push(Math.max(0,Math.round(base+(Math.random()*2-1)*jitter)));}arr[TOTAL_LINES-1]=TOTAL_DURATION-80;return arr;})();

let startedAt=performance.now();
function updateProgress(){const pct=Math.min(100,Math.round((performance.now()-startedAt)/TOTAL_DURATION*100));progressBar.style.width=pct+'%';}
function pushLine(text,important=false){const el=document.createElement('div');el.className='logLine';el.textContent=(important?'>>> ':localTimeString()+' ')+text;viewport.appendChild(el);while(viewport.children.length>220)viewport.removeChild(viewport.children[0]);requestAnimationFrame(()=>el.classList.add('visible'));viewport.scrollTop=viewport.scrollHeight;return el;}
function doVisualGlitch(){const targetIsHeader=Math.random()<0.1;if(targetIsHeader){header.classList.add('glitch');if(Math.random()<0.35)header.classList.add('glitchStrip');setTimeout(()=>{header.classList.remove('glitch');header.classList.remove('glitchStrip');},40+Math.random()*140);}else{const lines=Array.from(viewport.children).slice(-8);if(lines.length===0)return;const L=lines[Math.floor(Math.random()*lines.length)];L.classList.add('glitch');if(Math.random()<0.28)L.classList.add('glitchStrip');setTimeout(()=>{L.classList.remove('glitch');L.classList.remove('glitchStrip');},40+Math.random()*140);}}
const glitchInterval=setInterval(()=>{if(Math.random()<0.36)doVisualGlitch();},90+Math.random()*70);

function startEmission(){startedAt=performance.now();updateProgress();for(let i=0;i<TOTAL_LINES;i++){setTimeout(()=>{pushLine(makeLine());if(Math.random()<0.015){const imp=pushLine("Committing checkpoint and flushing I/O buffers...",true);imp.style.background='linear-gradient(90deg, rgba(255,204,51,0.04), rgba(255,153,0,0.02))';}},timestamps[i]);}

setTimeout(()=>{const finalEl=pushLine("DASBEM protocol engaged.",true);finalEl.classList.add('finalLine');},Math.max(TOTAL_DURATION-450,timestamps[TOTAL_LINES-1]));

const progressTicker=setInterval(()=>updateProgress(),20);
setTimeout(()=>{clearInterval(progressTicker);progressBar.style.width='100%';const flash=document.createElement('div');flash.style.position='fixed';flash.style.inset='0';flash.style.background='radial-gradient(circle at 50% 20%, rgba(255,220,120,0.08), rgba(0,0,0,0))';flash.style.pointerEvents='none';flash.style.opacity='0';flash.style.transition='opacity 260ms ease-out';document.body.appendChild(flash);requestAnimationFrame(()=>flash.style.opacity='1');setTimeout(()=>{flash.style.opacity='0';},220);setTimeout(()=>{try{window.location.href=REDIRECT;}catch(e){}},420);},TOTAL_DURATION+220);}

startEmission();
header.addEventListener('click',()=>{pushLine("User skip requested â€” entering main interface.",true).classList.add('finalLine');progressBar.style.width='100%';setTimeout(()=>{window.location.href=REDIRECT;},360);});
</script>
</body>
</html>
